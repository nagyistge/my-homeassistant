morningbriefing_simon:
  alias: Simon's Briefing
  sequence:
    - delay:
        seconds: 10
    - service: ifttt.trigger
      data_template:
        event: "ha_voip_message"
        value1: >
          {% if now().strftime("%H")|int < 12 %}
          Good morning, Simon.
          {% elif now().strftime("%H")|int < 18 %}
          Good afternoon.
          {% else %}
          Good evening.
          {% endif %}
          It's currently {{ now().strftime("%-I:%M %p") }}.
          {% if now().strftime("%H")|int < 12 %}
          You've slept for a total of {{ states('sensor.sleep_simon')|replace('h', ' hours and ')|replace('m', ' minutes')}}.
          {% endif %}
          It's currently {{ states('sensor.dark_sky_temperature')|int }} degrees,
          {% if now().strftime("%H")|int < 16 %}
          with a predicted high of {{ states('sensor.dark_sky_daily_high_temperature')|int }}.
          {% endif %}
          Tonight it will be {{ states('sensor.dark_sky_daily_low_temperature')|int }}.
          In the next 24 hours it will be {{ states('sensor.dark_sky_hourly_summary') }}.
          {% if is_state('calendar.garbage_collection', 'on') %}
          Remember, you need to put out the {{ states('sensor.garbage_type') }} bins.
          {% endif %}
          {% if states('device_tracker.simonflavellesipad.attributes.battery') | float < 10 %}
          You should also charge your iPad today. It's currently sitting at {{ states('sensor.simon_ipadbattery') | int }} percent.
          {% endif %}
